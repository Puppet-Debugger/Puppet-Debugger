import os
from enum import Enum


class DataManager:
    LogFile_Path: str

    def __init__(self) -> None:
        self.root = os.path.join(*[os.path.dirname(os.path.abspath(__file__))] + [".."] * 1)

    # Qiling日志管理函数
    def get_log_file_path(self, relative_path) -> str:
        self.LogFile_Path = os.path.join(self.root, relative_path)
        return self.LogFile_Path

    def del_log_file(self):
        os.remove(self.LogFile_Path)

    def data_del(self):
        """
        数据终末化函数
        """
        self.del_log_file()


Main_Data: DataManager = DataManager()


class PermissionType(Enum):
    READ = "r--"
    EXECUTE = "r-x"
    READ_WRITE = "rw-"
    READ_WRITE_EXECUTE = "rwx"


class SegmentType(Enum):
    EXECUTABLE = "executable"
    HEAP = "heap"
    LIBC = "libc"
    LD = "ld"
    STACK = "stack"
    OTHER = "other"


class HookType(Enum):
    CODE = "hook_code"
    BLOCK = "hook_block"
    MEM_READ = "hook_mem_read"
    MEM_WRITE = "hook_mem_write"
    MEM_EXEC = "hook_mem_fetch"
    INSTRUCTION = "hook_insn"
    INTERRUPT = "hook_intr"


class ArchType(Enum):
    X86 = 'X86'
    X8664 = 'X8664'
    ARM = 'ARM'
    ARM64 = 'ARM64'
    MIPS = 'MIPS'
    A8086 = 'A8086'
    EVM = 'EVM'
    CORTEX_M = 'CORTEX_M'
    RISCV = 'RISCV'
    RISCV64 = 'RISCV64'
    PPC = 'PPC'


class RegArmType(Enum):
    X0 = 'x0'
    X1 = 'x1'
    X2 = 'x2'
    X3 = 'x3'
    X4 = 'x4'
    X5 = 'x5'
    X6 = 'x6'
    X7 = 'x7'
    X8 = 'x8'
    X9 = 'x9'
    X10 = 'x10'
    X11 = 'x11'
    X12 = 'x12'
    X13 = 'x13'
    X14 = 'x14'
    X15 = 'x15'
    X16 = 'x16'
    X17 = 'x17'
    X18 = 'x18'
    X19 = 'x19'
    X20 = 'x20'
    X21 = 'x21'
    X22 = 'x22'
    X23 = 'x23'
    X24 = 'x24'
    X25 = 'x25'
    X26 = 'x26'
    X27 = 'x27'
    X28 = 'x28'
    X29 = 'x29'
    X30 = 'x30'
    SP = 'sp'
    PC = 'pc'
    LR = 'lr'
    CPACR_EL1 = 'cpacr_el1'
    TPIDR_EL0 = 'tpidr_el0'
    PSTATE = 'pstate'
    B0 = 'b0'
    B1 = 'b1'
    B2 = 'b2'
    B3 = 'b3'
    B4 = 'b4'
    B5 = 'b5'
    B6 = 'b6'
    B7 = 'b7'
    B8 = 'b8'
    B9 = 'b9'
    B10 = 'b10'
    B11 = 'b11'
    B12 = 'b12'
    B13 = 'b13'
    B14 = 'b14'
    B15 = 'b15'
    B16 = 'b16'
    B17 = 'b17'
    B18 = 'b18'
    B19 = 'b19'
    B20 = 'b20'
    B21 = 'b21'
    B22 = 'b22'
    B23 = 'b23'
    B24 = 'b24'
    B25 = 'b25'
    B26 = 'b26'
    B27 = 'b27'
    B28 = 'b28'
    B29 = 'b29'
    B30 = 'b30'
    B31 = 'b31'
    D0 = 'd0'
    D1 = 'd1'
    D2 = 'd2'
    D3 = 'd3'
    D4 = 'd4'
    D5 = 'd5'
    D6 = 'd6'
    D7 = 'd7'
    D8 = 'd8'
    D9 = 'd9'
    D10 = 'd10'
    D11 = 'd11'
    D12 = 'd12'
    D13 = 'd13'
    D14 = 'd14'
    D15 = 'd15'
    D16 = 'd16'
    D17 = 'd17'
    D18 = 'd18'
    D19 = 'd19'
    D20 = 'd20'
    D21 = 'd21'
    D22 = 'd22'
    D23 = 'd23'
    D24 = 'd24'
    D25 = 'd25'
    D26 = 'd26'
    D27 = 'd27'
    D28 = 'd28'
    D29 = 'd29'
    D30 = 'd30'
    D31 = 'd31'
    H0 = 'h0'
    H1 = 'h1'
    H2 = 'h2'
    H3 = 'h3'
    H4 = 'h4'
    H5 = 'h5'
    H6 = 'h6'
    H7 = 'h7'
    H8 = 'h8'
    H9 = 'h9'
    H10 = 'h10'
    H11 = 'h11'
    H12 = 'h12'
    H13 = 'h13'
    H14 = 'h14'
    H15 = 'h15'
    H16 = 'h16'
    H17 = 'h17'
    H18 = 'h18'
    H19 = 'h19'
    H20 = 'h20'
    H21 = 'h21'
    H22 = 'h22'
    H23 = 'h23'
    H24 = 'h24'
    H25 = 'h25'
    H26 = 'h26'
    H27 = 'h27'
    H28 = 'h28'
    H29 = 'h29'
    H30 = 'h30'
    H31 = 'h31'
    Q0 = 'q0'
    Q1 = 'q1'
    Q2 = 'q2'
    Q3 = 'q3'
    Q4 = 'q4'
    Q5 = 'q5'
    Q6 = 'q6'
    Q7 = 'q7'
    Q8 = 'q8'
    Q9 = 'q9'
    Q10 = 'q10'
    Q11 = 'q11'
    Q12 = 'q12'
    Q13 = 'q13'
    Q14 = 'q14'
    Q15 = 'q15'
    Q16 = 'q16'
    Q17 = 'q17'
    Q18 = 'q18'
    Q19 = 'q19'
    Q20 = 'q20'
    Q21 = 'q21'
    Q22 = 'q22'
    Q23 = 'q23'
    Q24 = 'q24'
    Q25 = 'q25'
    Q26 = 'q26'
    Q27 = 'q27'
    Q28 = 'q28'
    Q29 = 'q29'
    Q30 = 'q30'
    Q31 = 'q31'
    S0 = 's0'
    S1 = 's1'
    S2 = 's2'
    S3 = 's3'
    S4 = 's4'
    S5 = 's5'
    S6 = 's6'
    S7 = 's7'
    S8 = 's8'
    S9 = 's9'
    S10 = 's10'
    S11 = 's11'
    S12 = 's12'
    S13 = 's13'
    S14 = 's14'
    S15 = 's15'
    S16 = 's16'
    S17 = 's17'
    S18 = 's18'
    S19 = 's19'
    S20 = 's20'
    S21 = 's21'
    S22 = 's22'
    S23 = 's23'
    S24 = 's24'
    S25 = 's25'
    S26 = 's26'
    S27 = 's27'
    S28 = 's28'
    S29 = 's29'
    S30 = 's30'
    S31 = 's31'
    W0 = 'w0'
    W1 = 'w1'
    W2 = 'w2'
    W3 = 'w3'
    W4 = 'w4'
    W5 = 'w5'
    W6 = 'w6'
    W7 = 'w7'
    W8 = 'w8'
    W9 = 'w9'
    W10 = 'w10'
    W11 = 'w11'
    W12 = 'w12'
    W13 = 'w13'
    W14 = 'w14'
    W15 = 'w15'
    W16 = 'w16'
    W17 = 'w17'
    W18 = 'w18'
    W19 = 'w19'
    W20 = 'w20'
    W21 = 'w21'
    W22 = 'w22'
    W23 = 'w23'
    W24 = 'w24'
    W25 = 'w25'
    W26 = 'w26'
    W27 = 'w27'
    W28 = 'w28'
    W29 = 'w29'
    W30 = 'w30'
    V0 = 'v0'
    V1 = 'v1'
    V2 = 'v2'
    V3 = 'v3'
    V4 = 'v4'
    V5 = 'v5'
    V6 = 'v6'
    V7 = 'v7'
    V8 = 'v8'
    V9 = 'v9'
    V10 = 'v10'
    V11 = 'v11'
    V12 = 'v12'
    V13 = 'v13'
    V14 = 'v14'
    V15 = 'v15'
    V16 = 'v16'
    V17 = 'v17'
    V18 = 'v18'
    V19 = 'v19'
    V20 = 'v20'
    V21 = 'v21'
    V22 = 'v22'
    V23 = 'v23'
    V24 = 'v24'
    V25 = 'v25'
    V26 = 'v26'
    V27 = 'v27'
    V28 = 'v28'
    V29 = 'v29'
    V30 = 'v30'
    V31 = 'v31'
